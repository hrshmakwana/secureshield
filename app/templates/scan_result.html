{% extends 'base.html' %}
{% block content %}
<div class="card p-4">
  <h4>Scan Result</h4>
  <p class="text-muted">Target: {{ target_url }}</p>
  <div class="row g-3">
    <div class="col-md-4">
      <div class="card p-3 result-card {{ 'card-risk' if result.sqli else 'card-safe' }}">
        <p class="text-muted mb-1">SQL Injection</p>
        <h5 class="fw-bold">{{ 'VULNERABLE' if result.sqli else 'SAFE' }}</h5>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card p-3 result-card {{ 'card-risk' if result.xss else 'card-safe' }}">
        <p class="text-muted mb-1">Cross-Site Scripting</p>
        <h5 class="fw-bold">{{ 'VULNERABLE' if result.xss else 'SAFE' }}</h5>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card p-3 result-card                   {% if result.severity=='High' %}card-risk{% elif result.severity=='Medium' %}card-warn{% else %}card-safe{% endif %}">
        <p class="text-muted mb-1">Severity</p>
        <h5 class="fw-bold">{{ result.severity.upper() }}</h5>
      </div>
    </div>
  </div>
  <div class="mt-3">
    <h6 class="text-muted">Messages & Evidence</h6>
    <ul class="list-group list-group-flush">
      {% for msg in result.messages %}
      <li class="list-group-item bg-transparent text-light">{{ msg }}</li>
      {% endfor %}
      {% for ev in result.evidence %}
      <li class="list-group-item bg-transparent text-light">
        <span class="badge bg-secondary me-2">{{ ev.type }}</span>
        <small class="text-muted">payload:</small> {{ ev.payload }}
        {% if ev.snippet %}<div class="small text-muted mt-1">{{ ev.snippet }}</div>{% endif %}
        {% if ev.elapsed_ms %}<div class="small text-muted">elapsed: {{ ev.elapsed_ms }} ms</div>{% endif %}
      </li>
      {% endfor %}
    </ul>
  </div>
  <a class="btn btn-primary mt-3" href="{{ url_for('scan.history') }}">View History</a>
</div>
{% endblock %}
